https://mbed.org/users/Sissors/code/FastPWM/#98b1813977c6
